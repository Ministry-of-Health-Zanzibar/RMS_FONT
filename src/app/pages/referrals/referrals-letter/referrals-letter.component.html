<div
  id="print-section"
  *ngIf="referral"
  class="p-10 bg-white shadow-lg rounded-lg max-w-4xl mx-auto text-gray-900"
>
  <div class="flex justify-center mb-4">
    <img src="../../../../assets/img/smz.png" alt="" class="w-auto h-24" />
  </div>

  <div class="text-center space-y-1 mb-6">
    <p class="text-lg font-semibold">SERIKALI YA MAPINDUZI YA ZANZIBAR</p>
    <p class="text-lg font-semibold">WIZARA YA AFYA</p>

    <div class="grid grid-cols-2 gap-4 text-sm text-left">
      <div>
        <p>6 Barabara ya Health Office, S.L.P 236 MNANZIMMOJA</p>
        <p>POSTIKODI: 70467 Mjini Magharibi Zanzibar</p>
      </div>
      <div class="text-right">
        <p>
          Tovuti:
          <a href="http://www.mohz.go.tz" class="text-blue-600 hover:underline">
            www.mohz.go.tz
          </a>
        </p>
        <p>
          Barua pepe:
          <a
            href="mailto:{{ email || 'N/A' }}"
            class="text-blue-600 hover:underline"
          >
            {{ email || "N/A" }}
          </a>
        </p>
      </div>
    </div>
  </div>

  <hr />

  <div class="flex justify-between text-sm font-medium my-4">
    <p>KUMB: CDA.25/254/01</p>
    <p class="font-semibold uppercase">
      TAREHE: {{ referral.referral_letters?.start_date || 'N/A' | date:'dd-MM-yyyy' }}
    </p>
  </div>

  <div class="mb-6 space-y-1">
    <p class="font-semibold uppercase">MKURUGENZI MTENDAJI,</p>
    <p class="font-semibold uppercase">
      {{ referral.hospital?.hospital_name || "N/A" }},
    </p>
    <p class="font-semibold uppercase">
      {{ referral.hospital?.hospital_address || "N/A" }}
    </p>
    
  </div>

  <div class="mb-4 text-center">
    <p class="font-semibold uppercase">
      Kuh: KUMPATIA MATIBABU MGONJWA {{ referral.patient?.name || "N/A" }} {{ calculateAge(referral.patient?.date_of_birth) }}

    </p>
  </div>

  <div class="space-y-3 text-sm">
    <p>Tafadhali naomba uhusike na mada ya hapo juu.</p>
    <p>
      Wizara ya Afya Zanzibar, inamleta kwenu kwa uchunguzi na matibabu zaidi
      mtajwa hapo juu.
    </p>
    <p>
      Kwa barua hii, tunaomba mumpokee na kumpatia matibabu stahiki <b>{{ referral.patient?.name || "N/A" }}</b> kama tulivyokubaliana.
    </p>
    <p>
      Gharama za matibabu zitalipwa na Wizara ya Afya kwa mujibu wa Mkataba na
      <b>{{ referral.hospital?.hospital_name || "N/A" }}</b>
    </p>
    <p>
      Wizara ya Afya inaomba taarifa fupi za maendeleo ya matibabu kwa mhusika
      ikiwemo Diagnosis, Tiba aliyopewa, tathmini, na sababu ya kurudi mara
      nyingine.
    </p>
    <p>
      Aidha Wizara ya Afya inaomba ripoti kamili iwasilishwe mwishoni mwa
      matibabu.
    </p>
    <p>Naomba kuwasiliana kwa hatua.</p>
    <p><strong>Ahsante,</strong></p>
  </div>

  <div class="mt-8">
    <p class="font-semibold">DKT. AMOUR S. MOHAMED</p>
    <p class="font-semibold">MKURUGENZI MKUU</p>
    <p class="font-semibold">WIZARA YA AFYA</p>
    <p class="font-semibold">ZANZIBAR</p>
  </div>

  <mat-divider class="my-6"></mat-divider>

  <!-- Footer Info -->
  <div class="text-xs text-gray-600 text-center">
    <p><em><strong>Kwa mawasiliano ya moja kwa moja:</strong></em></p>
    <p>
      Waziri ..........., Katibu Mkuu .........., Mkurugenzi Mkuu barua pepe:
      <a [href]="'mailto:' + (dg || 'dg@mohz.go.tz')" class="text-blue-600 hover:underline">
        {{ dg || "dg@mohz.go.tz" }}
      </a>
    </p>
  </div>

  <!-- Print Button -->
  <div class="flex justify-end mt-8">
    <button (click)="print()" mat-raised-button color="primary" class="flex items-center gap-1">
      <mat-icon>print</mat-icon>
      Print
    </button>
  </div>
</div>
