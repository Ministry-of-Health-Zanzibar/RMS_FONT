<div class="p-10 space-y-8">
  <div class="flex justify-between items-center">
    <h1 class="text-lg font-bold">Bill Payments</h1>
    <!-- <button
      mat-icon-button
      color="primary"
      [disabled]="!dataSource || dataSource.data.length === 0"
      (click)="getPayment(dataSource.data[0]?.bill_file_id)"
      matTooltip="Add Payment"
    >
      <mat-icon>add</mat-icon>
    </button> -->
  </div>

  <div class="border rounded-lg overflow-hidden mt-4">
    <table
      mat-table
      [dataSource]="dataSource"
      class="min-w-full mat-elevation-z2"
    >
      <!-- Columns -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>No.</th>
        <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
      </ng-container>

      <ng-container matColumnDef="bill_file_id">
        <th mat-header-cell *matHeaderCellDef>No.</th>
        <td mat-cell *matCellDef="let element">{{ element.bill_file_id }}</td>
      </ng-container>

      <ng-container matColumnDef="hospital_name">
        <th mat-header-cell *matHeaderCellDef>Hospital</th>
        <td mat-cell *matCellDef="let element">
          {{ element.hospital_name }}
        </td>
      </ng-container>

      <ng-container matColumnDef="bill_file_title">
        <th mat-header-cell *matHeaderCellDef>Title</th>
        <td mat-cell *matCellDef="let element">
          {{ element.bill_file_title }}
        </td>
      </ng-container>

      <ng-container matColumnDef="pdf">
        <th mat-header-cell *matHeaderCellDef>View PDF</th>
        <td mat-cell *matCellDef="let element">
          <a
            *ngIf="element.bill_file?.endsWith('.pdf')"
            (click)="viewPDF(element)"
            class="inline-flex items-center gap-1 text-indigo-600 hover:text-indigo-800 cursor-pointer"
          >
            <mat-icon>picture_as_pdf</mat-icon> View PDF
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="bill_file_amount">
        <th mat-header-cell *matHeaderCellDef>Bill File amount(TZS)</th>
        <td mat-cell *matCellDef="let element">
          {{ element.bill_file_amount }}
        </td>
      </ng-container>

      <ng-container matColumnDef="paid_amount">
        <th mat-header-cell *matHeaderCellDef>Paid amount(TZS)</th>
        <td mat-cell *matCellDef="let element">
          {{ element.paid_amount }}
        </td>
      </ng-container>

      <ng-container matColumnDef="balance">
        <th mat-header-cell *matHeaderCellDef>Balance</th>
        <td mat-cell *matCellDef="let element">
          {{ element.balance }}
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let element">
          <span
            class="px-3 py-1 rounded-full text-xs font-semibold"
            [ngClass]="{
              'bg-green-100 text-green-700':
                element.status === 'Partially Paid',
              'bg-red-100 text-red-700': element.status === 'Denied',
              'bg-yellow-100 text-yellow-700': element.status === 'Pending'
            }"
          >
            {{ element.status }}
          </span>
        </td>
      </ng-container>

      <!-- Action Button -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let file">
          <button mat-icon-button [matMenuTriggerFor]="billFileMenu">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #billFileMenu="matMenu">
            <button mat-menu-item (click)="getPayment(file.bill_file_id)">
              <mat-icon color="primary">add</mat-icon>
              <span>Add Payment</span>
            </button>

            <button mat-menu-item (click)="displayMoreData(file)">
              <mat-icon class="font-icon">visibility</mat-icon>
              <span>View Bill pyment</span>
            </button>
          </mat-menu>
        </td>
      </ng-container>

      <!-- Header & Rows -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell text-center" colspan="9">No data available</td>
      </tr>
    </table>

    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>
