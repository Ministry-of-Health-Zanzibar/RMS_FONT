<div *ngIf="follow" class="max-w-7xl mx-auto p-6">
  <!-- Banner Header -->
  <div class="relative bg-gradient-to-r from-blue-700 to-blue-500 text-white rounded-2xl shadow-lg p-10 mb-8 flex items-center justify-center overflow-hidden">

    <!-- Left AI Image -->
    <img src="../../../../assets/img/doctor.png"
         alt="AI Left"
         class="absolute left-4 top-1/2 transform -translate-y-1/2 w-28 h-28 opacity-80 rounded-full shadow-lg">

    <!-- Center Text -->
    <div class="text-center z-10">
      <h1 class="text-4xl font-bold tracking-wide drop-shadow-md">Patient Follow up Records</h1>
      <p class="mt-3 text-lg opacity-90">A complete list of registered follow and their details</p>
    </div>

    <!-- Right AI Image -->
    <img src="../../../../assets/img/objective3.png"
         alt="AI Right"
         class="absolute right-4 top-1/2 transform -translate-y-1/2 w-28 h-28 opacity-80 rounded-full shadow-lg">

  </div>



  <!-- Patient Table -->
  <div class="bg-white shadow-xl rounded-2xl overflow-hidden">
  <!-- Table Header with Add Button -->
  <div class="flex justify-between items-center p-4 bg-gray-50 border-b">
    <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
      <mat-icon class="text-blue-600">assignment</mat-icon>
      Follow-up Records
    </h3>

  <button
  (click)="addFollow(referralId)"
  *ngIf="referralId && permission.parmissionMatched(['View FollowUp']) && follow?.status !== 'Closed'"
  matTooltip="Add Follow-up"
  class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all">
  <mat-icon>add_circle</mat-icon>
  Add Follow-up
</button>

  </div>

  <!-- Table -->
 <!-- Table -->
<table *ngIf="hospitalLetters && hospitalLetters.length > 0; else nofollow"
       class="table-auto w-full border-collapse border border-gray-300 shadow-md rounded-lg overflow-hidden">
  <thead class="bg-gray-100">
    <tr>
      <th class="border border-gray-300 p-2 text-center">#</th>
      <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">person</mat-icon>
        Patient Name
      </th>
         <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">card</mat-icon>
        Matibabu Card No
      </th>
         <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">description</mat-icon>
        Content Summary
      </th>
      <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">calendar_today</mat-icon>
        Next Appointment
      </th>
      <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">home</mat-icon>
        Outcome
      </th>
      <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">insert_drive_file</mat-icon>
        Letter File
      </th>
      <!-- <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">history</mat-icon>
        Follow-ups
      </th> -->
      <th class="border border-gray-300 p-2 text-center">
        <mat-icon class="text-gray-600 align-middle">print</mat-icon>
        Print
      </th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let letter of hospitalLetters; let i = index;" class="hover:bg-gray-50">
      <td class="border border-gray-300 p-2 text-center">{{ i + 1 }}</td>
      <td class="border border-gray-300 p-2 text-center">{{ follow.patient?.name }}</td>
       <td class="border border-gray-300 p-2 text-center">{{ follow.patient?.matibabu_card }}</td>
        <td class="border border-gray-300 p-2 text-center">{{ letter.content_summary }}</td>
     <td  class="border border-gray-300 p-2 text-center">
  {{ letter.next_appointment_date || '' }}
</td>

      <td class="border border-gray-300 p-2 text-center">{{ letter.outcome }}</td>

      <td class="border border-gray-300 p-2 text-center">
        <ng-container *ngIf="letter.letter_file; else noFile">

           <a
                *ngIf="letter?.letter_file"
                (click)="viewPDF(letter)"
                class="inline-flex items-center gap-1 text-indigo-600 hover:text-indigo-800 cursor-pointer"
              >
                <mat-icon>picture_as_pdf</mat-icon> View PDF
              </a>
        </ng-container>
        <ng-template #noFile>
          <span class="text-gray-400">No File</span>
        </ng-template>
      </td>
      <!-- <td class="border border-gray-300 p-2 text-center">
        <ul *ngIf="letter.followups && letter.followups.length > 0; else noFollowups"
            class="list-disc list-inside text-left text-sm text-gray-600">
          <li *ngFor="let f of letter.followups">
            {{ f.followup_date }}
          </li>
        </ul>
        <ng-template #noFollowups>
          <span class="text-gray-400">No Follow-ups</span>
        </ng-template>
      </td> -->
     <td class="border border-gray-300 p-2 text-center">
      <mat-icon
        class="cursor-pointer text-indigo-600 hover:text-indigo-800 transition"
        (click)="printFollowUp(follow)"
        matTooltip="Print Follow-up">
        print
      </mat-icon>
    </td>
    </tr>
  </tbody>
</table>


  <!-- Empty Message -->
  <ng-template #nofollow>
    <div class="text-center text-gray-500 p-6 bg-gray-50 rounded-lg shadow-md">
      No follow-up records available.
    </div>
  </ng-template>
</div>

</div>

