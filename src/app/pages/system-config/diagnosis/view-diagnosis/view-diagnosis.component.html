<div
  class="p-10 space-y-8 bg-gray-50 dark:bg-gray-900 min-h-screen"
  *ngIf="permission.parmissionMatched(['View Diagnoses'])"
>
  <!-- Header Section -->
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-200">
      ü©∫ Diagnosis Management
    </h1>
  </div>

  <!-- Card Container -->
  <div
    class="w-full bg-white dark:bg-gray-800 rounded-2xl shadow-lg border dark:border-gray-700 p-6"
  >
    <!-- Card Header -->
    <div
      class="font-semibold text-lg text-gray-800 dark:text-gray-100 border-b pb-3 border-gray-200 dark:border-gray-700 flex items-center justify-between"
    >
      <span>View Diagnosis</span>
    </div>

    <!-- Action Row -->
    <div
      class="mt-6 flex flex-col md:flex-row md:items-center justify-between gap-4"
    >
      <!-- Left: Search -->
      <div class="flex items-center gap-3 w-full md:w-auto">
        <button
          (click)="renew()"
          mat-icon-button
          matTooltip="Refresh"
          class="border border-gray-300 dark:border-gray-600 rounded-full p-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition"
        >
          <mat-icon>refresh</mat-icon>
        </button>

        <input
          type="text"
          placeholder="üîç Search diagnosis..."
          class="border-b h-10 w-80 text-sm bg-transparent dark:border-b-gray-500 outline-none focus:border-blue-500 px-2 transition"
          matInput
          (keyup)="applyFilter($event)"
          #input
        />
      </div>

      <!-- Right: Buttons -->
      <div class="flex space-x-3 justify-end">
        <!-- Download Button -->
        <button
          mat-stroked-button
          color="primary"
          class="!border-blue-500 !text-blue-600 hover:!bg-blue-50 flex items-center gap-2"
          (click)="downloadFile('diagnosis.xlsx')"
          *ngIf="permission.parmissionMatched(['Create Diagnoses'])"
        >
          <mat-icon>download</mat-icon>
          Download
        </button>

        <!-- Upload Button -->
        <button
          (click)="uploadFile()"
          class="bg-teal-600 hover:bg-teal-700 text-white text-sm py-2 px-4 rounded-lg flex items-center gap-2 shadow"
          *ngIf="permission.parmissionMatched(['Create Diagnoses'])"
        >
          <mat-icon>publish</mat-icon>
          Upload
        </button>

        <!-- Add Diagnosis -->
        <button
          mat-flat-button
          color="accent"
          class="bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center gap-2 shadow"
          (click)="addDiagnosis()"
          *ngIf="permission.parmissionMatched(['Create Diagnoses'])"
        >
          <mat-icon>add</mat-icon>
          Add Diagnosis
        </button>
      </div>
    </div>

    <!-- Table Section -->
    <div
      class="border dark:border-gray-700 rounded-lg overflow-hidden mt-6 shadow-sm bg-white dark:bg-gray-800"
    >
      <table mat-table [dataSource]="dataSource" class="w-full text-sm">
        <!-- Index -->
        <ng-container matColumnDef="id">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="text-gray-600 dark:text-gray-300 font-semibold"
          >
            #
          </th>
          <td mat-cell *matCellDef="let element; let i = index">
            {{ i + 1 }}
          </td>
        </ng-container>

        <!-- Code -->
        <ng-container matColumnDef="code">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="text-gray-600 dark:text-gray-300 font-semibold"
          >
            Code
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.diagnosis_code }}
          </td>
        </ng-container>

        <!-- Diagnosis Name -->
        <ng-container matColumnDef="name">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="text-gray-600 dark:text-gray-300 font-semibold"
          >
            Diagnosis Name
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.diagnosis_name }}
          </td>
        </ng-container>
          <!-- Weight Column -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef class="text-neutral-500 dark:text-neutral-400"> Action </th>
            <td mat-cell *matCellDef="let element">
              <mat-slide-toggle
                [checked]="!element.deleted_at"
                (toggleChange)="confirmBlock(element)"
                color="primary">
              </mat-slide-toggle>
            </td>
          </ng-container>

        <!-- Table Rows -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

        <!-- No Data -->
        <tr class="mat-row" *matNoDataRow>
          <td
            class="mat-cell text-center py-4 text-gray-500 dark:text-gray-400"
            colspan="10"
          >
            No data matching the filter ‚Äú{{ input.value }}‚Äù
          </td>
        </tr>
      </table>

      <mat-paginator
        [pageSizeOptions]="[10, 20 , 100]"
        showFirstLastButtons
        class="pt-4 bg-gray-50 dark:bg-gray-900"
      >
      </mat-paginator>
    </div>
  </div>
</div>
