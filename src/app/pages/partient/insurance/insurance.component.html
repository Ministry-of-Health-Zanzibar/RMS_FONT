
<div>
  <div class="w-full">
    <div class="relative h-full rounded-lg  group  p-6">

      <div *ngIf="id" class="font-semibold ">ADD PATIENT FORM</div>
      <form [formGroup]="patientForm" class="horizontal-form" enctype="multipart/form-data">

        <!-- Row 1: Full Name, Gender -->
        <div class="form-row">
          <mat-form-field class="form-field">
            <mat-label>Full Name</mat-label>
            <input matInput placeholder="Ex. Ali Juma Ali" formControlName="name" type="text">
            <mat-error *ngIf="patientForm.get('name')?.invalid && patientForm.get('name')?.touched">
              <span *ngIf="patientForm.get('name')?.errors?.['required']">This field is mandatory</span>
              <span *ngIf="patientForm.get('name')?.errors?.['pattern']">Must contain alphabetical characters only</span>
            </mat-error>
          </mat-form-field>

          <mat-form-field class="form-field">
            <mat-label>Gender</mat-label>
            <mat-select formControlName="gender">
              <mat-option value="Male">Male</mat-option>
              <mat-option value="Female">Female</mat-option>
            </mat-select>
            <mat-error *ngIf="patientForm.get('gender')?.invalid && patientForm.get('gender')?.touched">
              This field is mandatory
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Row 2: Address, Phone Number -->
        <div class="form-row">
          <mat-form-field class="form-field">
            <mat-label>Location</mat-label>
            <input type="text" matInput placeholder="public" formControlName="location" [matAutocomplete]="auto">
            <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
              <mat-option *ngFor="let option of filteredOptions | async; trackBy: trackById" [value]="option">
                {{ option.location_name }}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <!-- <mat-form-field class="form-field">
            <mat-label>Address</mat-label>
            <input matInput placeholder="Ex. MWERA" formControlName="location" type="text">
            <mat-error *ngIf="patientForm.get('location')?.invalid && patientForm.get('location')?.touched">
              <span *ngIf="patientForm.get('location')?.errors?.['required']">This field is mandatory</span>
              <span *ngIf="patientForm.get('location')?.errors?.['pattern']">Must contain alphabetical characters only</span>
            </mat-error>
          </mat-form-field> -->

          <mat-form-field class="form-field">
            <mat-label>Phone Number</mat-label>
            <input matInput placeholder="Ex. 0777000000" formControlName="phone" type="text">
            <mat-error *ngIf="patientForm.get('phone')?.invalid && patientForm.get('phone')?.touched">
              <span *ngIf="patientForm.get('phone')?.errors?.['required']">This field is mandatory</span>
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Row 3: Job, Position -->
        <div class="form-row">
          <mat-form-field class="form-field">
            <mat-label>Job</mat-label>
            <input matInput placeholder="Ex. Teacher" formControlName="job" type="text">
            <mat-error *ngIf="patientForm.get('job')?.invalid && patientForm.get('job')?.touched">
              <span *ngIf="patientForm.get('job')?.errors?.['required']">This field is mandatory</span>
            </mat-error>
          </mat-form-field>

          <mat-form-field class="form-field">
            <mat-label>Position</mat-label>
            <input matInput placeholder="Ex. HeadMaster" formControlName="position" type="text">
            <mat-error *ngIf="patientForm.get('position')?.invalid && patientForm.get('position')?.touched">
              <span *ngIf="patientForm.get('position')?.errors?.['required']">This field is mandatory</span>
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Row 4: Date of Birth, File Upload -->
        <div class="form-row">
          <mat-form-field class="form-field">
            <mat-label>Date of Birth</mat-label>
            <input matInput type="date" formControlName="date_of_birth">
            <mat-error *ngIf="patientForm.get('date_of_birth')?.invalid && patientForm.get('date_of_birth')?.touched">
              This field is mandatory
            </mat-error>
          </mat-form-field>

          <mat-form-field class="form-field">
            <mat-label>Upload File</mat-label>
            <input
              matInput
              type="text"
              formControlName="patient_file"
              readonly
              placeholder="No file chosen"
              (click)="fileInput.click()"
            />
            <input
              type="file"
              accept=".pdf,.doc,.docx,.jpg,.png"
              hidden
              #fileInput
              (change)="onAttachmentSelected($event)"
            />
            <mat-icon matSuffix style="cursor: pointer;" (click)="fileInput.click()">attach_file</mat-icon>
            <mat-error *ngIf="patientForm.get('patient_file')?.invalid && patientForm.get('patient_file')?.touched">
              File is required
            </mat-error>
          </mat-form-field>


        </div>

      </form>
    </div>
  </div>

  <mat-dialog-actions align ="end">
    <button mat-button mat-dialog-close>Cancel</button>
    <button *ngIf="id" mat-flat-button [mat-dialog-close]="true" cdkFocusInitial [disabled]="patientForm.invalid" (click)="saveClient()">Add Patient</button>
  </mat-dialog-actions>
</div>



